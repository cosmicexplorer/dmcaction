// Generated by CoffeeScript 2.6.1
var promisify;

({promisify} = require('util'));

import('../pkg').catch(console.error).then(async function({beep, unbeep, rebeep, examine_file, play_recorded}) {
  var b64Encoded, buffer, extractedData, file, handle, link, playButton, stopButton, uploadButton;
  handle = null;
  playButton = document.getElementById('play');
  stopButton = document.getElementById('stop');
  uploadButton = document.getElementById('upload');
  link = document.getElementById('link');
  playButton.addEventListener('click', function() {
    if (handle != null) {
      return rebeep(handle);
    } else {
      return handle = beep();
    }
  });
  stopButton.addEventListener('click', function() {
    if (handle != null) {
      return unbeep(handle);
    }
  });
  // handle.free()
  // handle = null
  file = (await new Promise(function(resolve, reject) {
    var handleFile;
    handleFile = function() {
      return resolve(this.files[0]);
    };
    return uploadButton.addEventListener('change', handleFile, false);
  }));
  console.log(file);
  buffer = new Uint8Array((await file.arrayBuffer()));
  extractedData = examine_file(file.name, file.type, buffer);
  b64Encoded = Buffer.from(extractedData).toString('base64');
  link.setAttribute('href', `data:audio/m4a;base64,${b64Encoded}`);
  link.setAttribute('download', file.name);
  return link.click();
});

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiPGFub255bW91cz4iXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUE7O0FBQUEsQ0FBQSxDQUFDLFNBQUQsQ0FBQSxHQUFjLE9BQUEsQ0FBUSxNQUFSLENBQWQ7O0FBRUEsTUFBQSxDQUFPLFFBQVAsQ0FDRSxDQUFDLEtBREgsQ0FDUyxPQUFPLENBQUMsS0FEakIsQ0FFRSxDQUFDLElBRkgsQ0FFUSxNQUFBLFFBQUEsQ0FBQyxDQUFDLElBQUQsRUFBTyxNQUFQLEVBQWUsTUFBZixFQUF1QixZQUF2QixFQUFxQyxhQUFyQyxDQUFELENBQUE7QUFDUixNQUFBLFVBQUEsRUFBQSxNQUFBLEVBQUEsYUFBQSxFQUFBLElBQUEsRUFBQSxNQUFBLEVBQUEsSUFBQSxFQUFBLFVBQUEsRUFBQSxVQUFBLEVBQUE7RUFBSSxNQUFBLEdBQVM7RUFDVCxVQUFBLEdBQWEsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsTUFBeEI7RUFDYixVQUFBLEdBQWEsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsTUFBeEI7RUFDYixZQUFBLEdBQWUsUUFBUSxDQUFDLGNBQVQsQ0FBd0IsUUFBeEI7RUFDZixJQUFBLEdBQU8sUUFBUSxDQUFDLGNBQVQsQ0FBd0IsTUFBeEI7RUFFUCxVQUFVLENBQUMsZ0JBQVgsQ0FBNEIsT0FBNUIsRUFBcUMsUUFBQSxDQUFBLENBQUE7SUFDbkMsSUFBRyxjQUFIO2FBQ0UsTUFBQSxDQUFPLE1BQVAsRUFERjtLQUFBLE1BQUE7YUFHRSxNQUFBLEdBQVMsSUFBQSxDQUFBLEVBSFg7O0VBRG1DLENBQXJDO0VBTUEsVUFBVSxDQUFDLGdCQUFYLENBQTRCLE9BQTVCLEVBQXFDLFFBQUEsQ0FBQSxDQUFBO0lBQ25DLElBQUcsY0FBSDthQUNFLE1BQUEsQ0FBTyxNQUFQLEVBREY7O0VBRG1DLENBQXJDLEVBWko7OztFQWtCSSxJQUFBLEdBQU8sQ0FBQSxNQUFNLElBQUksT0FBSixDQUFZLFFBQUEsQ0FBQyxPQUFELEVBQVUsTUFBVixDQUFBO0FBQzdCLFFBQUE7SUFBTSxVQUFBLEdBQWEsUUFBQSxDQUFBLENBQUE7YUFBRyxPQUFBLENBQVEsSUFBQyxDQUFBLEtBQUssQ0FBQyxDQUFELENBQWQ7SUFBSDtXQUNiLFlBQVksQ0FBQyxnQkFBYixDQUE4QixRQUE5QixFQUF3QyxVQUF4QyxFQUFvRCxLQUFwRDtFQUZ1QixDQUFaLENBQU47RUFJUCxPQUFPLENBQUMsR0FBUixDQUFZLElBQVo7RUFDQSxNQUFBLEdBQVMsSUFBSSxVQUFKLENBQWdCLENBQUEsTUFBTSxJQUFJLENBQUMsV0FBTCxDQUFBLENBQU4sQ0FBaEI7RUFDVCxhQUFBLEdBQWdCLFlBQUEsQ0FBYSxJQUFJLENBQUMsSUFBbEIsRUFBd0IsSUFBSSxDQUFDLElBQTdCLEVBQW1DLE1BQW5DO0VBQ2hCLFVBQUEsR0FBYSxNQUFNLENBQUMsSUFBUCxDQUFZLGFBQVosQ0FBMEIsQ0FBQyxRQUEzQixDQUFvQyxRQUFwQztFQUNiLElBQUksQ0FBQyxZQUFMLENBQWtCLE1BQWxCLEVBQTBCLENBQUEsc0JBQUEsQ0FBQSxDQUF5QixVQUF6QixDQUFBLENBQTFCO0VBQ0EsSUFBSSxDQUFDLFlBQUwsQ0FBa0IsVUFBbEIsRUFBOEIsSUFBSSxDQUFDLElBQW5DO1NBQ0EsSUFBSSxDQUFDLEtBQUwsQ0FBQTtBQTdCSSxDQUZSIiwic291cmNlc0NvbnRlbnQiOlsie3Byb21pc2lmeX0gPSByZXF1aXJlICd1dGlsJ1xuXG5pbXBvcnQoJy4uL3BrZycpXG4gIC5jYXRjaCBjb25zb2xlLmVycm9yXG4gIC50aGVuICh7YmVlcCwgdW5iZWVwLCByZWJlZXAsIGV4YW1pbmVfZmlsZSwgcGxheV9yZWNvcmRlZH0pIC0+XG4gICAgaGFuZGxlID0gbnVsbFxuICAgIHBsYXlCdXR0b24gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCAncGxheSdcbiAgICBzdG9wQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQgJ3N0b3AnXG4gICAgdXBsb2FkQnV0dG9uID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQgJ3VwbG9hZCdcbiAgICBsaW5rID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQgJ2xpbmsnXG5cbiAgICBwbGF5QnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIgJ2NsaWNrJywgLT5cbiAgICAgIGlmIGhhbmRsZT9cbiAgICAgICAgcmViZWVwIGhhbmRsZVxuICAgICAgZWxzZVxuICAgICAgICBoYW5kbGUgPSBiZWVwKClcblxuICAgIHN0b3BCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciAnY2xpY2snLCAtPlxuICAgICAgaWYgaGFuZGxlP1xuICAgICAgICB1bmJlZXAgaGFuZGxlXG4gICAgICAgICMgaGFuZGxlLmZyZWUoKVxuICAgICAgICAjIGhhbmRsZSA9IG51bGxcblxuICAgIGZpbGUgPSBhd2FpdCBuZXcgUHJvbWlzZSAocmVzb2x2ZSwgcmVqZWN0KSAtPlxuICAgICAgaGFuZGxlRmlsZSA9IC0+IHJlc29sdmUgQGZpbGVzWzBdXG4gICAgICB1cGxvYWRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lciAnY2hhbmdlJywgaGFuZGxlRmlsZSwgbm9cblxuICAgIGNvbnNvbGUubG9nIGZpbGVcbiAgICBidWZmZXIgPSBuZXcgVWludDhBcnJheSAoYXdhaXQgZmlsZS5hcnJheUJ1ZmZlcigpKVxuICAgIGV4dHJhY3RlZERhdGEgPSBleGFtaW5lX2ZpbGUgZmlsZS5uYW1lLCBmaWxlLnR5cGUsIGJ1ZmZlclxuICAgIGI2NEVuY29kZWQgPSBCdWZmZXIuZnJvbShleHRyYWN0ZWREYXRhKS50b1N0cmluZyAnYmFzZTY0J1xuICAgIGxpbmsuc2V0QXR0cmlidXRlICdocmVmJywgXCJkYXRhOmF1ZGlvL200YTtiYXNlNjQsI3tiNjRFbmNvZGVkfVwiXG4gICAgbGluay5zZXRBdHRyaWJ1dGUgJ2Rvd25sb2FkJywgZmlsZS5uYW1lXG4gICAgbGluay5jbGljaygpXG4iXX0=
//# sourceURL=coffeescript